{"version":2,"kind":"Notebook","sha256":"f4c5290b41e40136a2e2a113d12813a242578dc808142cdb5248f88d9c66c868","slug":"gaussianprocesses","location":"/GaussianProcesses.ipynb","dependencies":[],"frontmatter":{"title":"Coding & Writing Sample","authors":[{"nameParsed":{"literal":"Shane Grigsby","given":"Shane","family":"Grigsby"},"name":"Shane Grigsby","affiliations":["Cooperative Institute for Research in Environmental Sciences"],"id":"contributors-GaussianProcesses-generated-uid-0"}],"affiliations":[{"id":"Cooperative Institute for Research in Environmental Sciences","name":"Cooperative Institute for Research in Environmental Sciences"}],"date":"2025-05-07","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"thumbnail":"/build/b77199e99a54e59b2e3c037c2cc90f21.svg","exports":[{"format":"ipynb","filename":"GaussianProcesses.ipynb","url":"/build/GaussianProcesses-576aa7c934f9f410b88216c255be103e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Context for this coding & writing sample","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sS0Whit58h"}],"identifier":"context-for-this-coding-writing-sample","label":"Context for this coding & writing sample","html_id":"context-for-this-coding-writing-sample","implicit":true,"key":"XWDOb556wR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"I presented a version of this notebook on Tuesday, April 29th to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ez6sYsQbDX"},{"type":"link","url":"https://en.wikipedia.org/wiki/Fernando_P%C3%A9rez_(software_developer)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Fernando Perez","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"roFkHV5YVb"}],"urlSource":"https://en.wikipedia.org/wiki/Fernando_P%C3%A9rez_(software_developer)","data":{"page":"Fernando_P%C3%A9rez_(software_developer)","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"BvoLkGohRr"},{"type":"text","value":"’s research group at UC-Berkely as part of an ongoing biweekly collaboration for cross disciplinary open science. I’ve modified it slightly to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Yc45fdd94m"}],"key":"nTX3CTSNjL"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Add context that I had previously noted verbally","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tvEMfm477l"}],"key":"wcmgcwiQBE"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Reduce the computational complexity of the example so that it can run on a single ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BGHgTyQ0Gr"},{"type":"link","url":"https://jupyter.org/binder","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"binder","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LFIDfEC8te"}],"urlSource":"https://jupyter.org/binder","key":"wczCVm37kx"},{"type":"text","value":" instance","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sQUdXCvol5"}],"key":"pjj5ciEdwb"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Created a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rqWfl5dTKW"},{"type":"link","url":"https://github.com/espg/coding-sample","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"repository","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nsuKBwKSLb"}],"urlSource":"https://github.com/espg/coding-sample","error":true,"key":"rSxZ5gGiE2"},{"type":"text","value":" so that software dependencies can be built automatically, and the data is present for the binder instance","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xUH4WPu9g1"}],"key":"qmDfNuP9t4"}],"key":"FyzmV7FmY3"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This notebook can be run for free from any web browser be clicking the following binder link: ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cLVnFuGZUo"},{"type":"link","url":"https://mybinder.org/v2/gh/espg/coding-sample/HEAD?urlpath=%2Fdoc%2Ftree%2FGaussianProcesses.ipynb","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"image","url":"/build/b77199e99a54e59b2e3c037c2cc90f21.svg","alt":"Binder","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"USEqcHHovL","urlSource":"https://mybinder.org/badge_logo.svg"}],"urlSource":"https://mybinder.org/v2/gh/espg/coding-sample/HEAD?urlpath=%2Fdoc%2Ftree%2FGaussianProcesses.ipynb","key":"tKVjb2ny2s"}],"key":"S1isHryNPp"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Gaussian Processes (GPs) are a machine learning technique that has wide application-- including ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tQA5kW8fpe"},{"type":"link","url":"https://en.wikipedia.org/wiki/Neural_network_Gaussian_process","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Bayesian estimation of parameter weights","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"B7vJUY75gF"}],"urlSource":"https://en.wikipedia.org/wiki/Neural_network_Gaussian_process","data":{"page":"Neural_network_Gaussian_process","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"vxgvVLzEZe"},{"type":"text","value":" for neural networks. This coding sample provides an introduction to the background and basics around GPs, and unifies some\ndisparate terminology used by Data Scientists, Statisticians, and Earth Scientists.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"AuHoPQiBtX"}],"key":"lWnC2zXdOk"}],"key":"ZyOvVTyvxn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Gaussian Processes Prediction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hufr5eng61"}],"identifier":"gaussian-processes-prediction","label":"Gaussian Processes Prediction","html_id":"gaussian-processes-prediction","implicit":true,"key":"LsVkxPbRL7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Terminology in science is often confusing. For instance, Principle Component Analysis (PCA) and Empirical Orthogonal functions (EOF) are functionally the same numerical method, with EOFs being the preferred term in Atmospheric communities and PCA being the more general term used in broader statistical discussions. Similarly, Gaussian Processes is the general term used in physics and statistical learning for what the geosciences has traditionally termed ‘kriging’, and which some branches of math refer to as Wiener–Kolmogorov prediction.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mQNYdeDEe8"}],"key":"ntjbPcWRWb"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Gaussian Processes (GP) are perhaps best thought of as a collection of enhancements to the traditional kriging system. They are functionally equivalent to kriging (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KMEUgAw7Of"},{"type":"cite","url":"https://doi.org/10.1007/978-94-011-5014-9_23","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Williams (1998)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XneTqopajm"}],"kind":"narrative","label":"Williams_1998","identifier":"https://doi.org/10.1007/978-94-011-5014-9_23","enumerator":"1","key":"lF0t7liYkQ"},{"type":"text","value":"), and differ only in implantation details and slightly in philosophy. ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BVM7B2VMgX"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The GP philosophy treats interpolation as model selection from an infinite number of functions (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hBCjxG7n2L"},{"type":"cite","url":"https://doi.org/10.7551/mitpress/3206.001.0001","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Rasmussen & Williams (2005)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RlpcJu9y2T"}],"kind":"narrative","label":"Rasmussen_2005","identifier":"https://doi.org/10.7551/mitpress/3206.001.0001","enumerator":"2","key":"Vd9xriqkCg"},{"type":"text","value":")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yKj8Lud1xO"}],"key":"uRVQzyL48q"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AMUJ2E0Wwm"}],"key":"mhLdLt7l1N"},{"type":"image","url":"/build/5b8ae75218c2b71222b94cc7a0abdc35.png","alt":"gp.png","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lzovrD6rox","urlSource":"https://upload.wikimedia.org/wikipedia/commons/7/7f/Gaussian_Process_Regression.png","urlOptimized":"/build/5b8ae75218c2b71222b94cc7a0abdc35.webp"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The model of covariance determines which kinds of functions are in the prior. Observations then are used to select functions from the prior which are compatible with those observations. The distribution of those selected functions provide uncertainty estimation","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KMT5bT2D6L"}],"key":"RvLYwkJMeE"}],"key":"FOGWIWrbrZ"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Although stated somewhat differently, this Bayesian view fits with ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MawgxcMoFj"},{"type":"cite","url":"https://doi.org/10.2307/1425829","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Matheron’s","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nsjatXg9H3"}],"kind":"narrative","label":"Matheron_1973","identifier":"https://doi.org/10.2307/1425829","enumerator":"3","key":"qJXzCWb626"},{"type":"text","value":" discussion of random fields, and is a close match to ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Jtn3coWFPB"},{"type":"cite","url":"https://doi.org/10.1007/bf02067214","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Journal’s","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KdNT66gEWU"}],"kind":"narrative","label":"Journel_1977","identifier":"https://doi.org/10.1007/bf02067214","enumerator":"4","key":"GJC7XZAH28"},{"type":"text","value":" description of projection into various solution spaces. These ‘prior’ functions are not required to be linear, as the figure below demonstrates:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LCqGoQmAd9"}],"key":"Lbamewf72A"},{"type":"image","url":"/build/af20bbeeb575a136bc4a46923a3b5451.gif","alt":"animation.gif","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"u3lwAMO3NR","urlSource":"https://upload.wikimedia.org/wikipedia/commons/d/da/Gaussianprocess.gif","urlOptimized":"/build/af20bbeeb575a136bc4a46923a3b5451.webp"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"As number of predictions ‘P’ grows to be large above, the mean of all ‘P’ approaches the best estimate, with the variance of predictions indicating a confidence bound (i.e., the std. dev. of predictions)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"yQALsFFt0P"}],"key":"dmV6880GGj"}],"key":"sTd5CcdcRx"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The primary object of interest in kriging is the variogram","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"UgJwXc17i2"}],"key":"SwBKYZkERt"},{"type":"text","value":", which is the main method by which practitioners fit a covariance function. ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"VXcLG6PAQk"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"In contrast, the primary object of interest in GPs is the kernel, which is directly equivalent to covariances.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"okfTIFI8zo"}],"key":"y5ya4CB1yb"},{"type":"text","value":" The kernel formulation has significant computational savings, enabling solving of high dimensional kernel functions in low dimensional space via the kernel trick (i.e., computing only the inner products); the kernel formulation also admits easy translation to Fourier based methods when interpolating regular spaces (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Ga3EKTEHzB"},{"type":"cite","url":"https://doi.org/10.48550/arXiv.1302.4245","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Wilson & Adams (2013)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Tvx6qKsu2I"}],"kind":"narrative","label":"https://doi.org/10.48550/arxiv.1302.4245","identifier":"https://doi.org/10.48550/arXiv.1302.4245","enumerator":"5","key":"grXNZPnq6T"},{"type":"text","value":"). Kernel architecture is flexible, as valid kernels can be added or multiplied to form new synthesis kernels (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CnMop3PdOL"},{"type":"cite","url":"https://doi.org/10.1080/01621459.1999.10473885","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Cressie & Huang (1999)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"iZ4pMYyMVD"}],"kind":"narrative","label":"Cressie_1999","identifier":"https://doi.org/10.1080/01621459.1999.10473885","enumerator":"6","key":"OwpgxRySbu"},{"type":"text","value":"). For instance, non-stationary kernels can be combined with stationary kernels and white noise kernels, such that large spatial trends, local correlation and structure, and intrinsic random noise and error can be modeled and specified as discrete submodules and functions-- ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"vT3z4cTo3E"},{"type":"link","url":"https://towardsdatascience.com/gaussian-process-kernels-96bafb4dd63e/","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"see here for a practical example using Mauna Loa data","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xRhUSTigQe"}],"urlSource":"https://towardsdatascience.com/gaussian-process-kernels-96bafb4dd63e/","key":"zUMiTojjQD"},{"type":"text","value":" in scikit-learn. Kernels can also be bounded for more efficient computation—for instance, spherical kernels give rise to sparse gram matrices that can be reordered and solved by efficient sparse solvers; the Matérn kernel (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"HzyTnIFWOe"},{"type":"cite","url":"https://doi.org/10.1007/978-1-4615-7892-5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Matérn, 1960","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"rMUN728H4i"}],"kind":"narrative","label":"Mat_rn_1986","identifier":"https://doi.org/10.1007/978-1-4615-7892-5","enumerator":"7","key":"eiWyckIYXc"},{"type":"text","value":") can be modified to do the same. Separable non-stationary kernels can be written as a Kronecker tensor product (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"aoNsEqLpH2"},{"type":"cite","identifier":"genton","label":"genton","kind":"narrative","position":{"start":{"line":17,"column":1617},"end":{"line":17,"column":1624}},"children":[{"type":"text","value":"Genton (2002)","key":"pWh8xppgL0"}],"enumerator":"8","key":"qJWyfCqild"},{"type":"text","value":"), and solved in circulant matrixes by efficient Fourier methods (","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"w4tnZMLOz2"},{"type":"cite","url":"https://doi.org/10.48550/arXiv.1503.01057","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Wilson & Nickisch (2015)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Np5u28qc0B"}],"kind":"narrative","label":"https://doi.org/10.48550/arxiv.1503.01057","identifier":"https://doi.org/10.48550/arXiv.1503.01057","enumerator":"9","key":"NZ67wr3CCn"},{"type":"text","value":").","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Sxx9N49FHj"}],"key":"jEbq4Nb5Rk"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Although Gaussian Processes is the more general statistical term for covariance methods of prediction, the practice and term of kriging predates Gaussian Processes. Thus, to explain the history and theory of Gaussian Processes, we’ll start with kriging first.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"klri48U3X9"}],"key":"tyqA5D0ys2"}],"key":"aRVcxeiJqC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What is kriging (informally)?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fPiJIBMkhK"}],"identifier":"what-is-kriging-informally","label":"What is kriging (informally)?","html_id":"what-is-kriging-informally","implicit":true,"key":"dURF7MezHS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Generally speaking, most people use kriging as an interpolator. Classic interpolators can be split into ‘","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NS1ecWnbRG"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"estimators","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QLAQ8141f3"}],"key":"gDTwaD2keq"},{"type":"text","value":"’ and ‘","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i1nthKeGKr"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"predictors","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XDoWCq5CRC"}],"key":"aK6LqLQr5l"},{"type":"text","value":"’; this distinction (in line with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TZvLgpBMPP"},{"type":"cite","url":"https://doi.org/10.1007/bf00889887","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Cressie, 1990","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VWyB3zrJ59"}],"kind":"narrative","label":"Cressie_1990","identifier":"https://doi.org/10.1007/bf00889887","enumerator":"10","key":"jIehntVZeo"},{"type":"text","value":") mainly applies to highlight that ‘","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bnvQAZMF8w"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"estimators","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zJZJKCbkhS"}],"key":"i4Oy4Kkaxg"},{"type":"text","value":"’ provide an estimate of the surface, while ‘","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wiUTCWG3XO"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"predictors","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zYHCr96sQw"}],"key":"gHbZR87eqU"},{"type":"text","value":"’ assign a prediction that is accompanied by measures of confidence:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eoxNt81rzv"}],"key":"pRiQzD4yhQ"},{"type":"image","url":"/build/03d1076e4e32f4695734b1167c5c65c6.jpeg","alt":"image.jpg","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WquJoBFWJV","urlSource":"https://github.com/YuePanEdward/PPE_Kriging/blob/main/figures/result_dense_dataset.jpg?raw=true","urlOptimized":"/build/03d1076e4e32f4695734b1167c5c65c6.webp"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Estimators including nearest neighbor, bilinear interpolation, and cubic spline (bottom), as compared with kriging predictions using three different kernels (top). The middle row shows the variance of the kriging prediction, which shows how confident we are of the prediction at that location","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"d6NuHLs2Zy"}],"key":"PfWRBF8jQy"}],"key":"utt1QhajSB"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Traditional ‘","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hRbrRiWJkc"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"estimators","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kTjkzwUZr4"}],"key":"osc2mKMNQ0"},{"type":"text","value":"’ are of the fairly boring type that most are fairly familiar with— canonical examples are bilinear interpolation, Inverse Distance Weighting (IDW), cubic convolution, etc. Other non-traditional examples of ‘estimators’ include things like nearest and natural neighbor interpolation, which are appropriate for specific domain cases when you want to preserve original data values. If your ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"NEXAvn9bnp"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"goal","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qUk89xhoaF"}],"key":"U02MJSjSuH"},{"type":"text","value":" is ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fKOygEaJ9N"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"just","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"T8gA5cXSDP"}],"key":"akTlCIQEbZ"},{"type":"text","value":" interpolation ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ycBCmySrR7"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"and you have sufficient data","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vNPP96cbWO"}],"key":"leo9kHstUx"},{"type":"text","value":", using an estimator is perfectly fine-- and fast! However, if your data is ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MtxF38McKq"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"sparse","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VGHI68REnC"}],"key":"LlKN71rQCt"},{"type":"text","value":", kriging starts to become more appealing:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"x0Tl5R4F6P"}],"key":"kfaZiuII8d"},{"type":"image","url":"/build/bdb989a18e2c78b76f49ebabc3b22a39.jpeg","alt":"image.jpg","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ETcoy4f0La","urlSource":"https://github.com/YuePanEdward/PPE_Kriging/blob/main/figures/result_sparse_dataset.jpg?raw=true","urlOptimized":"/build/bdb989a18e2c78b76f49ebabc3b22a39.webp"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"There is less data, which is more widely spaced, so the uncertainty shown in the middle row has increased","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"hWYrwrigsv"}],"key":"ADyzNCp4DN"}],"key":"B0wxPW3DeP"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"This sparse estimation capability is why kriging was originally developed. Kriging is named after Danie G. Krige, who’s 1951 master’s thesis developed and described what we call ‘Simple Kriging’. Danie Krige was a prospector looking for gold in South Africa, an application that had sparse input measurements, and expensive sampling. Krige’s method was coined ‘kriging’ by the early 1960’s by French mathematician Georges Matheron, who formalized and expanded the method.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"xpYHti5u5j"}],"key":"rKfXg8S5SM"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Of course, the other case where kriging is appealing is when you need to use the method as a ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Xvs9IAhq05"},{"type":"emphasis","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"predictor","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"EkbAnCAAmN"}],"key":"faLYftfAJo"},{"type":"text","value":".","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"xgijEXVPyp"}],"key":"z4r02OeT5a"}],"key":"zOa1ayTlZd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Covariance, Gold, and the variogram model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EtweBlIsF1"}],"identifier":"covariance-gold-and-the-variogram-model","label":"Covariance, Gold, and the variogram model","html_id":"covariance-gold-and-the-variogram-model","implicit":true,"key":"KVp0dCHTTS"},{"type":"image","url":"/build/2ffed4862480bba556962ff294be9d78.gif","alt":"image.gif","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ABQLPWBqbM","urlSource":"https://vsp.pnnl.gov/help/image/Variogram.gif","urlOptimized":"/build/2ffed4862480bba556962ff294be9d78.webp"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Traditional kriging defines a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"P9DWpB7x6N"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"model of covariance","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uAgHxrs0hh"}],"key":"qj2EoCUojS"},{"type":"text","value":" by fitting a function to the empirical ‘variogram’, which plots the variance between observations as a function of distance between those observations. The variogram ‘sill’ refers to variance between uncorrelated samples, and the ‘range’ is the lag-distance at which this paired observation decorrelation occurs. The ‘nugget’ refers to the intrinsic variance (i.e., the observational uncertainty) at distance zero-- that is, the variance of a single point observation with itself. The term ‘nugget’ is literally referring to ‘gold nugget’ in the context of prospecting; i.e., finding a ‘nugget’ of gold which has been displaced from the source gold deposit... just because a ‘nugget’ is present at a location, does not guarantee that you are coincident with the gold deposit ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VYg9ECC2Zx"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"that generated that observation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Fde5XWPwkm"}],"key":"j0FAUwhbqH"},{"type":"text","value":"; however, the expectation is that the nugget is spatially close to the ore that it came from!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GPdcE7WuPV"}],"key":"wJlp8SmWc2"},{"type":"image","url":"/build/ff8c410b251590af858bbaf80f9b6717.png","alt":"image.png","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Q4NejBzefS","urlSource":"https://scikit-learn.org/stable/_images/sphx_glr_plot_gpr_noisy_targets_003.png","urlOptimized":"/build/ff8c410b251590af858bbaf80f9b6717.webp"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Mathematically, specifying a ‘nugget’ value (or ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"S7mPeV2UAR"},{"type":"inlineCode","value":"alpha","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uL7T5xqEON"},{"type":"text","value":" in GP terminology) is effectively adding a constant to the diagonal of the covariance matrix such that each observation has some level of variance with itself. Doing this allows flexibility for the mean of the predictions to ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"efZds4xiMK"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PQhntf9bjA"}],"key":"sNzxj3Zb6m"},{"type":"text","value":" intersect all of the observation points-- if covariance is set to unity along the diagonal, then any estimation will be a ‘rubber sheeting’ that ensures the output mean prediction passes through the original data points. Of course, we can also specify covariance ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"m4JlJr2o6s"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"per observation","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"p15jD5CUVa"}],"key":"Npn1cevE3b"},{"type":"text","value":" rather than as a constant along the diagonal, and selectively ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"g3BgWw7xmR"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"down weight","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xwnhjUcJVr"}],"key":"d0D5t8kZSg"},{"type":"text","value":" low confidence observations.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uFm2h7DGx5"}],"key":"vmEuqkg4z8"}],"key":"BCRunNWh5I"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What I use Gaussian Processes for","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vkSRkcHNdl"}],"identifier":"what-i-use-gaussian-processes-for","label":"What I use Gaussian Processes for","html_id":"what-i-use-gaussian-processes-for","implicit":true,"key":"RWZLCQCbuM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"My science background is Earth Science, specifically glaciology and hydrology around the polar ice systems. Much of what we know about glacial hydrology is from remote sensing observations, which we use machine learning to process.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kHaLJ8gVgW"}],"key":"CwLrqdfyiW"}],"key":"UzcJ17sZDx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline","key":"MPoaviRssT"},{"type":"output","id":"qIr7OkYh-7SARQ3zhpBmg","data":[],"key":"OPiqcDbS5e"}],"key":"CUgtbTLT6M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport pandas as pd\nimport numpy as np\nfrom tqdm.notebook import tqdm\nfrom osgeo import osr\nimport pyproj\nfrom sklearn.gaussian_process import GaussianProcessRegressor\nfrom sklearn.gaussian_process.kernels import Matern, WhiteKernel, RBF","key":"ASRHBo2c63"},{"type":"output","id":"qYbbdHwk_-0snb6167Zrr","data":[],"key":"ZmYN6LNlCG"}],"key":"k0hhTv55TS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data = pd.HDFStore(\"./Z62SU06\" + \".h5\", 'r') # ICESat data","key":"z5ireToZKI"},{"type":"output","id":"WuyGv6vzSD5vzS-zIuB3X","data":[],"key":"v6Z8T2uXvG"}],"key":"rY56XLNQZT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The filename ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"quzdBZ9n3f"},{"type":"inlineCode","value":"Z62SU06","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ugj6AsdJsx"},{"type":"text","value":" refers to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TuI2ADzL5K"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Z","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PbklQ0Fdp1"}],"key":"tlNsw4rxVn"},{"type":"text","value":"wally drainage basin ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uBD2rx51ql"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6.2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wMPsPDEec1"}],"key":"fozKk2KNUG"},{"type":"text","value":" from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kxQcUvYhki"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Su","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lTLaTtA6OZ"}],"key":"JEKqETMExS"},{"type":"text","value":"mmer of 20","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AitNPyLrpF"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"06","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kKD2YifXk8"}],"key":"rK7eljGjbA"},{"type":"text","value":", and the observations are from the first space based laser altimeter, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WYatYRwjY4"},{"type":"link","url":"https://icesat.gsfc.nasa.gov/icesat/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"NASA ICESat mission","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ds565DrUr8"}],"urlSource":"https://icesat.gsfc.nasa.gov/icesat/","key":"F7htGIZ0UF"},{"type":"text","value":". Here’s where basin 6.2 is in Greenland:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T5vQ5tzfMg"}],"key":"i412HHSMGz"},{"type":"image","url":"/build/7b0fad5d27c317ca02d1bb9b826be405.png","alt":"greenland.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mp9wov8j0h","urlSource":"https://earth.gsfc.nasa.gov/sites/default/files/lab_cryo/data/polar_ice_altimetry/antarctic_and_greenland_drainage_systems/grn_drainage_systems.png","urlOptimized":"/build/7b0fad5d27c317ca02d1bb9b826be405.webp"}],"key":"Ukh8MGtO2D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coordlist = data['coords'] # Needed for distance calculations / plotting\ndf_indices = data['indices'] # UUID to link to observations to slope retrievals\ndf_corr = data['corr'] # Filter and weight data\n\ngslope = np.load('./General_slopes.npy') # Sub ICESat footprint slope retrievals\nmean_slope = np.zeros(len(coordlist))\nstd_slope = np.zeros(len(coordlist))\n\n# Merge and aggregate slope\nfor i in tqdm(range(len(coordlist))):\n    sweights = np.array(df_corr.iloc[i].values)\n    weightidx = np.isfinite(sweights)\n    sweights = np.abs(sweights[weightidx])\n    sidx = df_indices.iloc[i].values[weightidx]\n    sidx = np.array(sidx, dtype=int)\n    mean_slope[i] = np.average(gslope[sidx], weights=sweights)\n    std_slope[i] = np.std(gslope[sidx])","key":"PLQ50wDmTN"},{"type":"output","id":"rwOlJv-DUpNhGY9ebiKE_","data":[{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"3cd06ca8728a4e99bb3cbdd3953fb313\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"  0%|          | 0/23359 [00:00<?, ?it/s]","content_type":"text/plain"}}}],"key":"pa0QI9yL0W"}],"key":"Nid6Ishl26"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This example is meant to be larger than a ‘toy’ dataset, but still small enough to interact with and demonstrate. Our input data consist of 23,359 observations which are within footprint slope retrievals from the first ICESat mission (which flew from 2003 to 2009, although laser power was strongest in the first three years).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ssrrDXsoJM"}],"key":"eFKT8vQpnh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here’s what the data looks like:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b7RLoVRrwY"}],"key":"kr22lXOsPY"}],"key":"DqcvJqBf7n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots()\nim = ax.scatter(coordlist.lon, coordlist.lat, c=mean_slope, s=std_slope**2)\nim.set_clim(min(mean_slope), max(mean_slope))\nplt.xlabel(\"Longitude\"), plt.ylabel(\"Latitude\")\nfig.colorbar(im, ax=ax, label=\"Degrees of slope \\n (points scaled by retrieval variance)\")\nplt.show()","key":"jckTdmrT2f"},{"type":"output","id":"L8DXZBQ2LL9MxUo8CHTFF","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c857ecf08002324a318bbbcd148dc7a3","path":"/build/c857ecf08002324a318bbbcd148dc7a3.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"MligzOcQk6"}],"key":"Hicd6RbF6X"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Each ‘line’ above is an orbital pass, also called a ‘track’. This is an interesting case of geostatistics because the sampling is quite odd-- the along track resolution is dense, but the across track resolution is sparse. Most of the code is actually setting up the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JDlo92ps5k"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"source","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cPBQm4dPv1"}],"key":"LI2GKQABuX"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rLQCJ3nQbv"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"target","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oUfdxradme"}],"key":"Iw5mn5ox1h"},{"type":"text","value":" coordinate systems for the model. The input observational data is irregularly spaced and in lat/lon coordinates (one degree of Latitude is 110km), but we want our distance measurements to be in Euclidean space and output to a grid.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ozdIx4dU3X"}],"key":"djY20nfRoZ"}],"key":"soyvh1PLKM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Projection object\nds = osr.SpatialReference()\nds.ImportFromEPSG(3411) # polar projection\nds.ExportToProj4()\np2 = pyproj.Proj(ds.ExportToProj4())\n\n# Observations to meters from lat / lon\nX, Y = p2(np.array(coordlist.lon),\n          np.array(coordlist.lat))\n# To vector form sklearn\ncoords_m = np.ones((len(coordlist),2))\ncoords_m[:,0] = X\ncoords_m[:,1] = Y","key":"Tfp7Z3RqKh"},{"type":"output","id":"X99rGO_Hwvk5Q8KMPQKgL","data":[],"key":"lyij0LUeYY"}],"key":"K56fod5IRH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our input (source) data was already filtered to drainage basin 6.2, but we also want to ‘clip’ the (target) results to a drainage basin. This is for two reasons-- first, the drainage basin boundaries are at zero surface slope and provide a physically meaningful way to bound, divide, and tile the analysis. And second, covariance functions are expensive, so clipping and masking the edges of our area of interest helps things run faster... it also makes the output look good!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H6hFMDXM7B"}],"key":"KJf8VAKglS"}],"key":"YixDQhTnsf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Drainage basin boundries\nzwally = pd.read_csv('./GrnDrainageSystems_Ekholm.txt',\n                     sep=r\"\\s+\", names=['basin', 'lat','long'])\nbasin = '6.2'\nLL = zip(zwally[zwally.basin == float(basin)].long,\n         zwally[zwally.basin == float(basin)].lat)\nLL = list(LL)\n# Convert basin boundries to meters from lat / lon\npX, pY = p2(np.array(LL)[:,0],\n            np.array(LL)[:,1])\n# Polygon object for masking\nZ = mpl.path.Path(list(zip(pX, pY)))\n\n# Setting up kriging grid\nx1, y1 = np.meshgrid(np.r_[round(min(pX), -2) - 2500:round(max(pX), -2) + 2500:5000],\n                     np.r_[round(min(pY), -2) - 2500:round(max(pY), -2) + 2500:5000])\nkcoords = np.vstack([x1.ravel(),y1.ravel()]).T\n\n# Masking kriging grid\nZidx = Z.contains_points(kcoords[:])\ntarget_c = kcoords[Zidx] # Target coordinates\nx1.shape, len(target_c)","key":"utF54aVEaA"},{"type":"output","id":"Q_9MljDlaGWwsdDVkn1nP","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"((108, 110), 5600)","content_type":"text/plain"}}}],"key":"SsoLSPFSi1"}],"key":"gxsugzLS4i"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"At this point, we’ve setup a 5-km grid to predict on that’s 108 by 110 (a little over 500km per side), which after masking has 5,600 target coordinate locations to predict at.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EEWW3dbHY6"}],"key":"CwcbsfIlDv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Our source observations are too large for a binder instance to use for the GP model, which is n-squared in memory complexity with number of observations. We subsample by randomly selecting 4,000 observations to fit our model to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D9DrZKU0DA"}],"key":"vGf541hkBl"}],"key":"J5G1zXDYLr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rng = np.random.default_rng() # numpy sampling API\nnp.random.seed(12)\nind = np.array(range(0,len(coordlist)), dtype=int) # index values to map to observations\nidxs = np.random.choice(ind, size=4000) # randomly pick 4,000 indices","key":"clptt4UuSb"},{"type":"output","id":"eo1zyk8RUPD6EtxdN0v5T","data":[],"key":"G4FuapaJha"}],"key":"CpoSOv00gf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The actual Gaussian Process model specification is fairly short:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pKsCOV7XbM"}],"key":"OXnK4TbyU9"}],"key":"npoYNsD6Nf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nnoise = WhiteKernel(noise_level=.5)\nrbf = 3 * RBF(length_scale=[80000,80000])\nkern = 2.0 * Matern(length_scale=[80000,80000], length_scale_bounds=(1e3, 1e6),\n                        nu=0.5)\ngp1 = GaussianProcessRegressor(kernel=rbf+kern+noise, alpha=std_slope[idxs]**2, optimizer=None).fit(coords_m[idxs], mean_slope[idxs])","key":"NsoFmsPrYa"},{"type":"output","id":"nJvG0qkbefsbBJVNM-g9y","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 4.79 s, sys: 1.86 s, total: 6.64 s\nWall time: 1.01 s\n"}],"key":"xnVjo2RoIN"}],"key":"nJWBznAkjr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We are specifying a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zc3CIE3c33"},{"type":"inlineCode","value":"Matern","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hoj3EXl9PQ"},{"type":"text","value":" kernel to calculate and estimate our local covariance structure, which is defined by the single parameter ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OA5fRtX4hO"},{"type":"inlineCode","value":"nu","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dOFYTZQjEG"},{"type":"text","value":"; this parameter controls how smooth the functions are within our prior distribution of possible surface functions. It is set at 0.5 (i.e., ‘1 / 2’, equivalent the absolute exponential kernel) to allow rough, non-differentiable candidate functions; a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fU43Lhad5h"},{"type":"inlineCode","value":"nu=1.5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jl7dLN03Ls"},{"type":"text","value":" (3 / 2) will select from functions that are once differentiable, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DJmZtwImsj"},{"type":"inlineCode","value":"nu=2.5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l9vveGLS8s"},{"type":"text","value":" (5 / 2) will select from functions that are twice differentiable, and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DbcFkBgCzJ"},{"type":"inlineCode","value":"nu=inf","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p6AUB55xJ3"},{"type":"text","value":" will converge to the infinitely differentiable ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wp3RtwZhFD"},{"type":"inlineCode","value":"RBF","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hn3LNwVaiH"},{"type":"text","value":" kernel. In addition to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hpq0pfeJSL"},{"type":"inlineCode","value":"Matern","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mFoSAMfmDg"},{"type":"text","value":" kernel, I’ve also added an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MJX8T9M2rl"},{"type":"inlineCode","value":"RBF","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kpUROr99Jk"},{"type":"text","value":" kernel to model the large scale gradient of slope as it decreases moving inland, and a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F6DM9OgLe8"},{"type":"inlineCode","value":"WhiteKernel","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xQBpv5CQmN"},{"type":"text","value":" to reflect that we expect some noise in the input data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ccTnF7H1eU"}],"key":"vyqMheWwM2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rGnCkUJWyq"},{"type":"inlineCode","value":"length_scale","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"od8XmM9oPa"},{"type":"text","value":" parameter would typically be optimized during model fit based on the spatial structure of the data... however, because our input data is heavily unbalanced (i.e., dense in the along track direction, sparse in the across track), hyper-parameter optimization sets a length scale that is too short, so it is fixed at 80km, with similar settings applied for the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lrtcvr8Nwy"},{"type":"inlineCode","value":"length_scale_bounds","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mFLPkwFQBt"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IpmZXRpfbj"}],"key":"hG2Xy77P5F"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"After model specification, at ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a2RTxTz6NE"},{"type":"inlineCode","value":"fit","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zcmj42lh6s"},{"type":"text","value":" time we provide the coordinates, and slope values, along with an ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rxjVqS0hQP"},{"type":"inlineCode","value":"alpha","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pn1OLeGbRU"},{"type":"text","value":" that is set to variance of slope retrieval (i.e., estimates of variance per observation).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZOWyuIeIzP"}],"key":"kNSr3yZKld"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We can get the mean surface estimate and target-to-target covariances with the following:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"WdrZsE5ly8"}],"key":"Y6zK40UqYP"}],"key":"ou0zBE5GQK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\ny_mean, y_cov = gp1.predict(target_c, return_cov=True)","key":"ThweiYT4P0"},{"type":"output","id":"ThklGmSP1XEhHr9dZ6sW6","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 11.2 s, sys: 2.98 s, total: 14.1 s\nWall time: 2.02 s\n"}],"key":"aDQQq2Yx3p"}],"key":"Ug3yuLGDCj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’ll return to plot the results after discussing what is actually happening in the cell above.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NKoKsPrNGj"}],"key":"OF056BVABi"}],"key":"GTNJHo2XjP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What is kriging (formally)?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xkxapKzUkv"}],"identifier":"what-is-kriging-formally","label":"What is kriging (formally)?","html_id":"what-is-kriging-formally","implicit":true,"key":"MYLYeELW0A"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Mathematically, kriging is the Best Unbiased Linear ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vwZtRJgqXr"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Predictor","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LT3h8hIV7w"}],"key":"X2Y4mWiT6q"},{"type":"text","value":" (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"j0MbGPuRMc"},{"type":"cite","url":"https://doi.org/10.1007/bf02067214","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(Journel (1977)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RURGXr9osM"}],"kind":"narrative","label":"Journel_1977","identifier":"https://doi.org/10.1007/bf02067214","enumerator":"4","key":"iyYHJeYcZK"},{"type":"text","value":" ; ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C04L8mccaA"},{"type":"cite","url":"https://doi.org/10.1007/bf00889887","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Cressie (1990)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uyfCdAOEQd"}],"kind":"narrative","label":"Cressie_1990","identifier":"https://doi.org/10.1007/bf00889887","enumerator":"10","key":"ibDWzc1m0B"},{"type":"text","value":" ; ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gGORSa3C3W"},{"type":"cite","url":"https://doi.org/10.1080/00401706.1993.10485354","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Handcock & Stein (1993)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tymVcIDmLh"}],"kind":"narrative","label":"Handcock_1993","identifier":"https://doi.org/10.1080/00401706.1993.10485354","enumerator":"11","key":"XMOempnwwL"},{"type":"text","value":"), and provides the Best Linear Unbiased Prediction, or BLUP; this means that kriging prediction is a linear combination of weighted observations at point p that minimizes prediction variance. Note that this is different (but related) to the Best Linear Unbiased ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N8dgFEvZ7j"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Estimation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nhACGqLzwH"}],"key":"GJ5nDp9den"},{"type":"text","value":", or BLUE... although when using kriging to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q4f1atXaK2"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"estimate","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CdaaFU4MbX"}],"key":"h6omluMOWp"},{"type":"text","value":" a quantity, the results will be equivalent to the BLUE, which is why kriging is often conceptually understood as equivalent to spatially weighted least squares regression. Below is mathematical formulation for simple kriging, which assumes we are modeling a stationary (i.e., zero mean) process.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h3c5l28eaA"}],"key":"fBvzgWzad1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We adopt the standard convention of using ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PcuWDcy38D"},{"type":"inlineMath","value":"s_i","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">s_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Hsr6nuPniF"},{"type":"text","value":" for ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IXkr01lGhU"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"source","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Et0fzBZ0eG"}],"key":"RtZv7eWYg6"},{"type":"text","value":" observations (known), and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"evCmUXF2DH"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NyZI7ldieu"},{"type":"text","value":" for ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"G2ypGaw9Sp"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"target","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"G6kWK6XZUs"}],"key":"KhTpApmA94"},{"type":"text","value":" predictions (predicted). Given ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"w3rLarDLIp"},{"type":"inlineMath","value":"N","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"QlmNGHWHYL"},{"type":"text","value":" observations ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uyjZnXF1qO"},{"type":"inlineMath","value":"(s_1…s_n)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>…</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(s_1…s_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"q5ajiinjuh"},{"type":"text","value":", and a covariance function ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qkDkVkm5Z9"},{"type":"inlineMath","value":"f_{cov}()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>c</mi><mi>o</mi><mi>v</mi></mrow></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_{cov}()</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">co</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mclose\">)</span></span></span></span>","key":"dnNAMxHrA9"},{"type":"text","value":", we calculate distances ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RO3BzrqV0t"},{"type":"inlineMath","value":"D","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"H8qPsT8ZbQ"},{"type":"text","value":" of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VcPokyTuyt"},{"type":"inlineMath","value":"N","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"ODotE85vNT"},{"type":"text","value":" ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cUOtL1fTbP"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"source","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pmWdF7UNX1"}],"key":"ZjAVhQMRBY"},{"type":"text","value":" observations, and use either a function or kernel for source covariances ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XMsemIyItQ"},{"type":"inlineMath","value":"C_{obs}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{obs}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iDKfHfQuwY"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GpDAgj2hJH"}],"key":"bKPLwAL6eZ"},{"type":"math","value":"D(s_1 ... s_n, s_1 ... s_n) = D_{obs}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>s</mi><mi>n</mi></msub><mo separator=\"true\">,</mo><msub><mi>s</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>s</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D(s_1 ... s_n, s_1 ... s_n) = D_{obs}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"QvwndmPn3A"},{"type":"math","value":"C_{obs} = f_{cov}(D_{obs}) \\quad \\textrm{or} \\quad C(\\mathbf{x}_n, \\mathbf{x}_m) = k(\\mathbf{x}_n, \\mathbf{x}_m)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>f</mi><mrow><mi>c</mi><mi>o</mi><mi>v</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mtext>or</mtext><mspace width=\"1em\"/><mi>C</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>n</mi></msub><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">x</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>k</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>n</mi></msub><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">x</mi><mi>m</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C_{obs} = f_{cov}(D_{obs}) \\quad \\textrm{or} \\quad C(\\mathbf{x}_n, \\mathbf{x}_m) = k(\\mathbf{x}_n, \\mathbf{x}_m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">co</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord textrm\">or</span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"W4RyFIz4bq"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This is what is happening here:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"acLyMlxUzF"}],"key":"gFFpGQq1Px"},{"type":"code","lang":"python","value":"kern = 1.0 * Matern(length_scale=[80000,80000], length_scale_bounds=(1e3, 1e6),\n                        nu=0.5)\ngp1 = GaussianProcessRegressor(kernel=kern, alpha=std_slope**2, optimizer=None).fit(coords_m, mean_slope)","position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"key":"WlumY8mMO9"}],"key":"pSDCpygkcZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We are selecting a covariance function (i.e., the Matern kernel), and then ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GkOmu5fQ1y"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"fitting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MAq0LbvJua"}],"key":"kLl3IYyoqA"},{"type":"text","value":" that function to our observations on the basis of distance in order to estimate source-to-source covariance, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"djPHbaS3HP"},{"type":"inlineMath","value":"C_{obs}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{obs}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"W8hDcZK9av"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KSRt3S8h89"}],"key":"CYG4IaXOIH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Using the assumption that covariance can now be specified as a function of distance, we can model the covariance between our observations and prediction locations, that is the covariance between the source and target locations ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IrRQKdJHWd"},{"type":"inlineMath","value":"C_{obs\\_pred}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{obs\\_pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0503em;vertical-align:-0.367em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.367em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Xh3n46EOJ0"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ITbZm384Wj"}],"key":"Ur8vHsy2EB"},{"type":"math","value":"D(s_1 ... s_n, t_1 ... t_n) = D_{obs\\_pred}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>s</mi><mi>n</mi></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>t</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D(s_1 ... s_n, t_1 ... t_n) = D_{obs\\_pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0503em;vertical-align:-0.367em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.367em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"B1XnqAeGeh"},{"type":"math","value":"C_{obs\\_pred} = f_{cov}(D_{obs\\_pred})","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><msub><mi>f</mi><mrow><mi>c</mi><mi>o</mi><mi>v</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C_{obs\\_pred} = f_{cov}(D_{obs\\_pred})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0503em;vertical-align:-0.367em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.367em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.117em;vertical-align:-0.367em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">co</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.367em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"4","key":"pz5qEfKF7U"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"While we don’t actually know the target prediction values of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"gOMnbB1b1t"},{"type":"inlineMath","value":"t_1…t_n","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>…</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_1…t_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IqOpsKNZEV"},{"type":"text","value":" above, ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nMVinrpcgb"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"we do know the locations","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"mmRymhSQaL"}],"key":"PtYfRvkCAj"},{"type":"text","value":" of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"H7A5bWeccz"},{"type":"inlineMath","value":"t_1…t_n","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>…</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_1…t_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FKu6P3mNeZ"},{"type":"text","value":", and hence we can calculate their distances from our source ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ghTOtOxCMb"},{"type":"inlineMath","value":"s_1 ... s_n","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>s</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">s_1 ... s_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ckQIDnlopU"},{"type":"text","value":" locations. This also means we can model the covariance of the predictions ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Okh2bGzf9R"},{"type":"inlineMath","value":"t_1…t_n","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>…</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_1…t_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wE1VB6XXy2"},{"type":"text","value":" as a function of distance, under the assumption that ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NJRXYOCuME"},{"type":"inlineMath","value":"C_{pred}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AYcLhppskq"},{"type":"text","value":" has the same spatial structure as ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RBu6ggQEoC"},{"type":"inlineMath","value":"C_{obs}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{obs}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"eMoI4izjbD"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"u9PWhLfN2v"}],"key":"DP0XECvtV2"},{"type":"math","value":"D(t_1 ... t_n, t_1 ... t_n) = D_{pred}","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>t</mi><mi>n</mi></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>t</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>D</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D(t_1 ... t_n, t_1 ... t_n) = D_{pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"dtwx2WZAjv"},{"type":"math","value":"C_{pred} = f_{cov}(D_{pred})","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><msub><mi>f</mi><mrow><mi>c</mi><mi>o</mi><mi>v</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C_{pred} = f_{cov}(D_{pred})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">co</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"6","key":"bqeeZhOdKy"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"We obtain the kriging weights ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"pq1KtRr8W4"},{"type":"inlineMath","value":"W","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>","key":"EgzGYL7VVT"},{"type":"text","value":" by linear regression of the source-to-source covariances onto the source-to-target target covariances:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zSbRXuZjnm"}],"key":"WK7h4itGtj"},{"type":"math","value":"W = C_{obs}^{-1} \\cdot C_{obs\\_pred}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>W</mi><mo>=</mo><msubsup><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>⋅</mo><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W = C_{obs}^{-1} \\cdot C_{obs\\_pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1555em;vertical-align:-0.2914em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.4086em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2914em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0503em;vertical-align:-0.367em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.367em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"VgMsi3ZoRc"}],"key":"SmWFxbUGS1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Above we see the key computational constraint for kriging; we need to be able to invert an N by N observation covariance matrix. Kriging is considered spatially weighted least squares because the covariances are calculated as a function of distance, and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HO7yRfmEXQ"},{"type":"inlineMath","value":"C_{obs}^{-1} \\cdot C_{obs\\_pred}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>⋅</mo><msub><mi>C</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{obs}^{-1} \\cdot C_{obs\\_pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1555em;vertical-align:-0.3013em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8542em;\"><span style=\"top:-2.3987em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span></span></span></span><span style=\"top:-3.1031em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3013em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0503em;vertical-align:-0.367em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.367em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MJUljb2P5m"},{"type":"text","value":" is Ordinary Least Squares fitting-- which is equivalent to maximum likelihood estimation. The regression/kriging weights are identical for both the observations and their covariances, and we now have enough information to make a kriging/Lstsq’s prediction at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AhFZ5vvyzE"},{"type":"inlineMath","value":"t_1…t_n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>…</mo><msub><mi>t</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_1…t_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xocjgkT4WY"},{"type":"text","value":" target locations:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qopMMjHHOV"}],"key":"ktXcFA6pjF"},{"type":"math","value":"[t_1…t_n] =  W^T \\cdot [s_1…s_n]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>t</mi><mn>1</mn></msub><mo>…</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo><mo>=</mo><msup><mi>W</mi><mi>T</mi></msup><mo>⋅</mo><mo stretchy=\"false\">[</mo><msub><mi>s</mi><mn>1</mn></msub><mo>…</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[t_1…t_n] =  W^T \\cdot [s_1…s_n]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span></span>","enumerator":"8","key":"t9IOxMJIMa"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The kriging weights are used to produce a prediction at each target location that is a weighted linear combination of our source observation data, which is why the technique is the “Best Linear Unbiased Prediction”-- it is a prediction from a linear combination of observations, with the combination weighting determined by maximum likelihood estimation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lcjLKu1lMK"}],"key":"xGYmPS6n9k"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Our ‘mean’ prediction (and the steps above to retrieve them), happens at this call, which also returns the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"u66quWDocJ"},{"type":"inlineMath","value":"C_{pred}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hQIPZKmIsQ"},{"type":"text","value":":","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GFrfQ2f9BT"}],"key":"sOP3yzZpXe"},{"type":"code","lang":"python","value":"y_mean, y_cov = gp1.predict(target_c, return_cov=True)","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"key":"nssBbQ8dfE"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"This gives us the mean of all possible predictions, i.e., ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ym4D9Rkid5"},{"type":"inlineCode","value":"y_mean","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mNuYrHkkMr"},{"type":"text","value":" above. If we want to get ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"r9nP13cQRL"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"a prediction","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"qWhBCf67LC"}],"key":"UzOHM0PbsY"},{"type":"text","value":" instead of the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"SoD5XvGuJ9"},{"type":"emphasis","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"mean of predictions","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"QVlykOlLbi"}],"key":"USAsDYCox3"},{"type":"text","value":", we use the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"R4FQXQephR"},{"type":"inlineMath","value":"C_{pred}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{pred}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">re</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WiEeHR8VbU"},{"type":"text","value":" to draw spatially correlated simulations, which are added to that mean. Specifically, we can preform simulation via Cholesky decomposition* using the derived mean target predictions, and the target-to-target covariance:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aiNSKZKevD"}],"key":"KvOqrTZMJE"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"(from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jEf5yl495L"},{"type":"link","url":"https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/gaussian_process/_gpr.py","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"sklearn gaussian process module","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Y2ZXEk1flW"}],"urlSource":"https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/gaussian_process/_gpr.py","data":{"kind":"file","org":"scikit-learn","repo":"scikit-learn","reference":"main","file":"sklearn/gaussian_process/_gpr.py","raw":"https://raw.githubusercontent.com/scikit-learn/scikit-learn/main/sklearn/gaussian_process/_gpr.py"},"internal":false,"protocol":"github","key":"w2CLL3gPoT"},{"type":"text","value":"):","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"NgTGIjVe0C"}],"key":"kUq0j0wVlc"},{"type":"code","lang":"python","value":"    def sample_y(self, X, n_samples=1, random_state=0):\n        \"\"\"Draw samples from Gaussian process and evaluate at X.\n\n        Parameters\n        ----------\n        X : array-like of shape (n_samples_X, n_features) or list of object\n            Query points where the GP is evaluated.\n\n        n_samples : int, default=1\n            Number of samples drawn from the Gaussian process per query point.\n\n        random_state : int, RandomState instance or None, default=0\n            Determines random number generation to randomly draw samples.\n            Pass an int for reproducible results across multiple function\n            calls.\n            See :term:`Glossary <random_state>`.\n\n        Returns\n        -------\n        y_samples : ndarray of shape (n_samples_X, n_samples), or \\\n            (n_samples_X, n_targets, n_samples)\n            Values of n_samples samples drawn from Gaussian process and\n            evaluated at query points.\n        \"\"\"\n        rng = check_random_state(random_state)\n\n        y_mean, y_cov = self.predict(X, return_cov=True)\n        if y_mean.ndim == 1:\n            y_samples = rng.multivariate_normal(y_mean, y_cov, n_samples).T\n        else:\n            y_samples = [\n                rng.multivariate_normal(\n                    y_mean[:, target], y_cov[..., target], n_samples\n                ).T[:, np.newaxis]\n                for target in range(y_mean.shape[1])\n            ]\n            y_samples = np.hstack(y_samples)\n        return y_samples","position":{"start":{"line":16,"column":1},"end":{"line":55,"column":1}},"key":"d48WkntMn3"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"*Since we know that our covariance function produces a positive definite gram matrix of covariances, we use cholesky because ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"T1Gi54JAj5"},{"type":"link","url":"https://numpy.org/doc/2.2/reference/random/generated/numpy.random.Generator.multivariate_normal.html#numpy.random.Generator.multivariate_normal","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"it is faster than SVD or eigen decomposition","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"fHU5bTVyyL"}],"urlSource":"https://numpy.org/doc/2.2/reference/random/generated/numpy.random.Generator.multivariate_normal.html#numpy.random.Generator.multivariate_normal","key":"PRh3UuAq8C"},{"type":"text","value":". (The cholesky, SVD, or eigen decomposition is what is called behind the scene for the ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"tMBAyTFTtQ"},{"type":"inlineCode","value":"rng.multivariate_normal","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"OpaKdURK0V"},{"type":"text","value":" function above.)","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"WkT9yHsT7G"}],"key":"BuqGiJ8fCk"}],"key":"AWQiF90nj1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why do we care about ‘Prediction’ of slope for glaciology?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f4MdN6iTpC"}],"identifier":"why-do-we-care-about-prediction-of-slope-for-glaciology","label":"Why do we care about ‘Prediction’ of slope for glaciology?","html_id":"why-do-we-care-about-prediction-of-slope-for-glaciology","implicit":true,"key":"Ze70HGnaAT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Slope is an important variable for glaciologists, but it also doesn’t vary much on the icesheet-- it goes from about 2 degrees at the edge where it’s ‘steep’, before gradually dropping down to 1 in the interior and eventually 0 at the drainage boundary. However, things change when the surface is crevassed; cracks present a range of surface heights and angles, and generally those retrievals are ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pl9bIeGwor"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Wm9CeVuQty"}],"key":"wtsyxwNjYY"},{"type":"text","value":" flat:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O06V2WIQDA"}],"key":"bMKaSfm0tT"},{"type":"image","url":"/build/2512d9514f8cea92b98928a183ca7b6b.jpeg","alt":"crevs.jpg","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m83WcnSkp3","urlSource":"https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Parque_estatal_Chugach%2C_Alaska%2C_Estados_Unidos%2C_2017-08-22%2C_DD_94.jpg/1280px-Parque_estatal_Chugach%2C_Alaska%2C_Estados_Unidos%2C_2017-08-22%2C_DD_94.jpg","urlOptimized":"/build/2512d9514f8cea92b98928a183ca7b6b.webp"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Crevasses on the Greenland icesheet aren’t static features, they are linked to hydrologic system, occur seasonally, and can open (or close) on the time scale of hours:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZDAmk13MuN"}],"key":"ufSOLpdcGt"},{"type":"image","url":"/build/ace0909b885e72ede25c591961842363.webp","alt":"image.png","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"pgfwWTgF8L","urlSource":"https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41467-018-03420-8/MediaObjects/41467_2018_3420_Fig5_HTML.jpg?as=webp"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Figure from our ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IjktaklsTd"},{"type":"cite","url":"https://doi.org/10.1038/s41467-018-03420-8","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2018 Nature Communications Paper","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"y7hXAhiIvf"}],"kind":"narrative","label":"Christoffersen_2018","identifier":"https://doi.org/10.1038/s41467-018-03420-8","enumerator":"12","key":"el62xffrcc"}],"key":"BJbnKw82r5"}],"key":"l2ND27YZYS"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Although we’ve had satellites for Earth Science since the 1970’s starting with the Landsat missions, the record in the arctic is ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"U6TShnD4g4"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"much","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZuIs8TN1Z3"}],"key":"EQliF2aBlq"},{"type":"text","value":" shorter. The Landsat satellites acquired more data than they had capacity to download, and prioritized downloading data over the United States-- areas over the polar ice sheets and the oceans ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"O7y2DM2pPo"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"were deleted","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vnAaBdIENF"}],"key":"x0XVpuKEMl"},{"type":"text","value":" until the last decade. We’ve only had consistent remote sensing coverage of the polar icesheets for about a decade, which makes it possible to infer how things are now, but hard to infer trends in how things are changing. Our current ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"d7JrPK02dc"},{"type":"link","url":"https://sites.ps.uci.edu/morlighem/dataproducts/bedmachine-greenland/","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"best observational model of Greenland is Bedmap","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YWsnxuRfFP"}],"urlSource":"https://sites.ps.uci.edu/morlighem/dataproducts/bedmachine-greenland/","key":"CyJ3NFwij4"},{"type":"text","value":" (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"esymZgyxyy"},{"type":"cite","url":"https://doi.org/10.1002/2017GL074954","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Morlighem, 2017","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"W8gvQtey9n"}],"kind":"narrative","label":"Morlighem_2017","identifier":"https://doi.org/10.1002/2017GL074954","enumerator":"13","key":"su258z9erj"},{"type":"text","value":"), which a snapshot from 2010 airborne flights modeled over a 150-meter spaced grid. The ICESat mission launched in 2003, has our earliest measurements of elevation and slope across the entire icesheet.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"EH78b1CsHp"}],"key":"pqQUJMUN2m"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"If we are looking for crevasses, which are often transitory, we can try and infer them from slope ‘anomalies’ that we see in the ICESat data record. We know that the ‘background’ slope of the ice sheet is 3 degrees of slope or lower, and it would be nice to know when and in what areas that slope is exceeded. With simulations of possible slope surfaces, we can count how often 3 degrees of slope is exceeded for a given location:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"PDQMYPLFqX"}],"key":"Nji8iFxLH9"}],"key":"xGyz7FwhYa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nrealizations = rng.multivariate_normal(y_mean, y_cov, size=100, method='cholesky')","key":"UvP7HGvQZz"},{"type":"output","id":"DvXJVn3JHOiFDZpGflJfM","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 6.9 s, sys: 1.93 s, total: 8.83 s\nWall time: 1.02 s\n"}],"key":"fXsi8LskZn"}],"key":"RC3DRDARNP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"results1 = np.ones(len(kcoords)) *np.nan\nresults1[Zidx] =  realizations[5]\nshow_res1 = results1.reshape((x1.shape))\nplt.imshow(np.flipud(show_res1), vmin=2)\nplt.colorbar()\nplt.show()","key":"oFjk9qrUXP"},{"type":"output","id":"OHQKE_iFPb2rjQHO0YvFW","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"23c18d768eced2580bee4cb8dbd2a4fa","path":"/build/23c18d768eced2580bee4cb8dbd2a4fa.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"zPsk2Br6xn"}],"key":"WBT0nqBP1G"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is one possible ‘realization’ of areas that likely have slopes above 2 degrees, and be crevassed; we can easily look at another:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WDcB6wWpQ9"}],"key":"NF51mBtrQL"}],"key":"Tonp15vrnp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"results1 = np.ones(len(kcoords)) *np.nan\nresults1[Zidx] =  realizations[9]\nshow_res1 = results1.reshape((x1.shape))\nplt.imshow(np.flipud(show_res1), vmin=2)\nplt.colorbar()\nplt.show()","key":"JoRvQ7A93H"},{"type":"output","id":"PN9Kgdl-aSH7nyf-SZstU","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"48f5dd318470049d693ee5e6a505a965","path":"/build/48f5dd318470049d693ee5e6a505a965.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"UZUDMToWlx"}],"key":"JiO6ZYHoVJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ultimately, we take all 100 of our simulations, and count when we exceed our slope threshold to get an envelope estimate of where (in the summer of 2006) it was observationally probable to have crevassing:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WQyYpBlItH"}],"key":"pOBsnTf9fT"}],"key":"Gebko5rRT7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"occurance = np.zeros(5600, dtype=np.int64)\nfor i in realizations:\n    occurance += i > 3","key":"bH4Nzkpk4x"},{"type":"output","id":"YqGXD8ccRRXR66VDLwiG5","data":[],"key":"RT6y35bobb"}],"key":"ovm1dINGmy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"results1 = np.ones(len(kcoords)) *np.nan\nresults1[Zidx] =  occurance\nshow_res1 = results1.reshape((x1.shape))\nplt.imshow(np.flipud(show_res1)) #, norm=mpl.colors.LogNorm())\nticks = np.array([0,20,40,60,80])\nyticks = np.array([100,80,60,40,20])\nplt.xticks(ticks[1:],(ticks[0:-1]*5))\nplt.yticks(yticks,(ticks*5))\nplt.colorbar()\nplt.show()","key":"xCdNuwxXqu"},{"type":"output","id":"vpUO3-de9_p8R_w04lYP-","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"71608787bb60291c52a25f060b7a99ac","path":"/build/71608787bb60291c52a25f060b7a99ac.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"kn6th4wYhY"}],"key":"vPltRq2Nwy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There appears to be a crevasse field that’s opened around 150 kilometers inland (around 400 km north of the bottom edge of the drainage basin). This is what the area looked like in early June of 2010 at 300 km north of the basin boundary (red lines denote stress/strain that is high enough for 10 meter deep crevasses to form):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"azsf34Vlrh"}],"key":"PrXK3u4V26"},{"type":"image","url":"/build/e6c9d8de0f779a9381e3f30a9f31fcc4.webp","alt":"image.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zGZp2f8Q2D","urlSource":"https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41467-018-03420-8/MediaObjects/41467_2018_3420_Fig3_HTML.jpg?as=webp"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"So stochastic simulations from Gaussian Process modeling suggests crevassing at or above 100 km inland has also happened seasonally in the past north of where we observe it in 2010, with much weaker signal for possible slope anomalies beyond 200 km inland.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"A0vyx4lgDX"}],"key":"SHFtwBMO3M"}],"key":"x7TmyAXOK6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notes on Covariance and Kernels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U0M6Qp4auq"}],"identifier":"notes-on-covariance-and-kernels","label":"Notes on Covariance and Kernels","html_id":"notes-on-covariance-and-kernels","implicit":true,"key":"NavByhvCjg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Several things are apparent for the kriging description above, that highlight both the strengths and weakness of the approach. First and foremost, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vcu9g5nD6I"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"the approach is dependent on specification of a proper covariance function, or combination of kernels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yZMcpEIl6S"}],"key":"MyNvG3ooyp"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OdsgY7ABMc"}],"key":"jpGigXk2m1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Observe the following GP kernels (i.e., covariance models), fitted to the same data; note that every model consistently ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hUv4pYMCCZ"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"predicts","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CQzOnx1Eym"}],"key":"JF3sfkLzFy"},{"type":"text","value":" an additional drop ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GCsnoz6voW"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"beyond the observations","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"y7qzyCmIoZ"}],"key":"axwuaVICx6"},{"type":"text","value":" between x=4 and x=5; this is a strength of GPs, since interpolation using most other estimators cannot exceed the min/max of the observation space, even if the data is indicative of a trend!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uDphhUKyQZ"}],"key":"ofae1MvYJh"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"image","url":"/build/640cbbfcbbe6456d9de17be99a0b8710.png","alt":"gp1.png","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AObNka6HUZ","urlSource":"https://scikit-learn.org/stable/_images/sphx_glr_plot_gpr_prior_posterior_001.png","urlOptimized":"/build/640cbbfcbbe6456d9de17be99a0b8710.webp"},{"type":"text","value":"\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RHoi7Dm7z8"},{"type":"image","url":"/build/02c12096c474beb07b01aa952e6d7321.png","alt":"gp1.png","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EsXJQMvfSs","urlSource":"https://scikit-learn.org/stable/_images/sphx_glr_plot_gpr_prior_posterior_002.png","urlOptimized":"/build/02c12096c474beb07b01aa952e6d7321.webp"}],"key":"xh7mOTDIwt"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Note that the next kernel is modeling period functions (applicable to basin and range features)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AZSvAb1Dq1"}],"key":"Aq2rSPK5Rc"}],"key":"vWlZTVzE8C"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"image","url":"/build/d5647b7711a1f652476f0e28745cc0ab.png","alt":"gp1.png","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kz5659uBRQ","urlSource":"https://scikit-learn.org/stable/_images/sphx_glr_plot_gpr_prior_posterior_003.png","urlOptimized":"/build/d5647b7711a1f652476f0e28745cc0ab.webp"},{"type":"text","value":"\n","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tx9TS1Lmca"},{"type":"image","url":"/build/3a9cdfda5457eba4bcbf6bf31a4c9441.png","alt":"gp1.png","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"lMeHCv3sI2","urlSource":"https://scikit-learn.org/stable/_images/sphx_glr_plot_gpr_prior_posterior_005.png","urlOptimized":"/build/3a9cdfda5457eba4bcbf6bf31a4c9441.webp"}],"key":"R7906sqEqf"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The covariance function must be invertible; that is it must be positive definite (Genton, 2002)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"leHb6YV9KB"}],"key":"NRSsAXG4FR"},{"type":"text","value":", and the machine that runs the computation must be capable of inverting a N by N matrix. In practice, the N by N inversion can be relaxed if only the ‘best’ prediction is desired (since it can be derived via lstsq calculation); ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"nv7YfpFWZo"},{"type":"emphasis","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"however, simulation and error estimation requires inversion of an N by N matrix.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GeYZxC1iHW"}],"key":"dQstjYe3P5"},{"type":"text","value":" ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"uOuRZrq8KF"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In practice, empirical covariance almost always provides a non-invertible (not positive definite) gram matrix (","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"YBZg4n3lwK"},{"type":"cite","identifier":"10.1080/00401706.1993.10485354","label":"Handcock_1993","kind":"narrative","position":{"start":{"line":15,"column":525},"end":{"line":15,"column":556}},"children":[{"type":"text","value":"Handcock & Stein (1993)","key":"BGFpdgIK3A"}],"enumerator":"11","key":"POgpsqd1FL"},{"type":"text","value":"); further, a model of covariance is needed to estimate source to target and target to target covariance—so estimation of a covariance function, either via a variogram or by other methods, is always required for geostatistical interpolation and simulation.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"SPeHJ3ZuDD"}],"key":"rlV986kMwd"},{"type":"text","value":" The error estimation that kriging gives per prediction is error estimation on the assumption that modeled covariance structure is true! Kriging has been characterized as the Best Unbiased Linear Predictor (BULP)… which it is, for a given covariance function. Swapping covariance functions gives different and competing BLUPs, which then need to be evaluated via inter-model comparison (","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Z5PDl5KGvM"},{"type":"cite","url":"https://doi.org/10.1162/neco.1992.4.3.415","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"MacKay (1992)","key":"bGEHkGUlwo"}],"kind":"narrative","label":"MacKay_1992","identifier":"https://doi.org/10.1162/neco.1992.4.3.415","enumerator":"14","key":"hlISXAs7sn"},{"type":"text","value":"). In short, the kriging error and uncertainty estimation is not the absolute error estimate for the surface, and probability estimation of a prediction must be obtained with other models to give realistic confidence bounds. There are also various flavors of kriging (ordinary, universal, block, etc.) (see ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"A1j3RCsLA8"},{"type":"cite","url":"10.1007/bf02067214","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Journel","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"bi7LP42gs9"}],"kind":"narrative","label":"Journel_1977","identifier":"10.1007/bf02067214","enumerator":"4","key":"dztRiOOOww"},{"type":"text","value":"), which are similar to above, and account for non-stationarity.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"cKC867UbAZ"}],"key":"EjJvb4pBev"}],"key":"VjKy7M64KX"}],"key":"y7CxIjp9pN"},"references":{"cite":{"order":["Williams_1998","Rasmussen_2005","Matheron_1973","Journel_1977","https://doi.org/10.48550/arxiv.1302.4245","Cressie_1999","Mat_rn_1986","genton","https://doi.org/10.48550/arxiv.1503.01057","Cressie_1990","Handcock_1993","Christoffersen_2018","Morlighem_2017","MacKay_1992"],"data":{"Williams_1998":{"label":"Williams_1998","enumerator":"1","doi":"10.1007/978-94-011-5014-9_23","html":"Williams, C. K. I. (1998). Prediction with Gaussian Processes: From Linear Regression to Linear Prediction and Beyond. In <i>Learning in Graphical Models</i> (pp. 599–621). Springer Netherlands. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-94-011-5014-9_23\">10.1007/978-94-011-5014-9_23</a>","url":"https://doi.org/10.1007/978-94-011-5014-9_23"},"Rasmussen_2005":{"label":"Rasmussen_2005","enumerator":"2","doi":"10.7551/mitpress/3206.001.0001","html":"Rasmussen, C. E., & Williams, C. K. I. (2005). <i>Gaussian Processes for Machine Learning</i>. The MIT Press. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.7551/mitpress/3206.001.0001\">10.7551/mitpress/3206.001.0001</a>","url":"https://doi.org/10.7551/mitpress/3206.001.0001"},"Matheron_1973":{"label":"Matheron_1973","enumerator":"3","doi":"10.2307/1425829","html":"Matheron, G. (1973). The intrinsic random functions and their applications. <i>Advances in Applied Probability</i>, <i>5</i>(3), 439–468. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.2307/1425829\">10.2307/1425829</a>","url":"https://doi.org/10.2307/1425829"},"Journel_1977":{"label":"Journel_1977","enumerator":"4","doi":"10.1007/bf02067214","html":"Journel, A. G. (1977). Kriging in terms of projections. <i>Mathematical Geology</i>, <i>9</i>(6), 563–586. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/bf02067214\">10.1007/bf02067214</a>","url":"https://doi.org/10.1007/bf02067214"},"https://doi.org/10.48550/arxiv.1302.4245":{"label":"https://doi.org/10.48550/arxiv.1302.4245","enumerator":"5","doi":"10.48550/ARXIV.1302.4245","html":"Wilson, A. G., & Adams, R. P. (2013). <i>Gaussian Process Kernels for Pattern Discovery and Extrapolation</i>. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.48550/ARXIV.1302.4245\">10.48550/ARXIV.1302.4245</a>","url":"https://doi.org/10.48550/ARXIV.1302.4245"},"Cressie_1999":{"label":"Cressie_1999","enumerator":"6","doi":"10.1080/01621459.1999.10473885","html":"Cressie, N., & Huang, H.-C. (1999). Classes of Nonseparable, Spatio-Temporal Stationary Covariance Functions. <i>Journal of the American Statistical Association</i>, <i>94</i>(448), 1330–1339. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1080/01621459.1999.10473885\">10.1080/01621459.1999.10473885</a>","url":"https://doi.org/10.1080/01621459.1999.10473885"},"Mat_rn_1986":{"label":"Mat_rn_1986","enumerator":"7","doi":"10.1007/978-1-4615-7892-5","html":"Matérn, B. (1986). Spatial Variation. In <i>Lecture Notes in Statistics</i>. Springer New York. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-1-4615-7892-5\">10.1007/978-1-4615-7892-5</a>","url":"https://doi.org/10.1007/978-1-4615-7892-5"},"genton":{"label":"genton","enumerator":"8","doi":"10.5555/944790.944815","html":"Genton, M. G. (2002). Classes of kernels for machine learning: a statistics perspective. <i>J. Mach. Learn. Res.</i>, <i>2</i>, 299–312. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5555/944790.944815\">10.5555/944790.944815</a>","url":"https://doi.org/10.5555/944790.944815"},"https://doi.org/10.48550/arxiv.1503.01057":{"label":"https://doi.org/10.48550/arxiv.1503.01057","enumerator":"9","doi":"10.48550/ARXIV.1503.01057","html":"Wilson, A. G., & Nickisch, H. (2015). <i>Kernel Interpolation for Scalable Structured Gaussian Processes (KISS-GP)</i>. arXiv. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.48550/ARXIV.1503.01057\">10.48550/ARXIV.1503.01057</a>","url":"https://doi.org/10.48550/ARXIV.1503.01057"},"Cressie_1990":{"label":"Cressie_1990","enumerator":"10","doi":"10.1007/bf00889887","html":"Cressie, N. (1990). The origins of kriging. <i>Mathematical Geology</i>, <i>22</i>(3), 239–252. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/bf00889887\">10.1007/bf00889887</a>","url":"https://doi.org/10.1007/bf00889887"},"Handcock_1993":{"label":"Handcock_1993","enumerator":"11","doi":"10.1080/00401706.1993.10485354","html":"Handcock, M. S., & Stein, M. L. (1993). A Bayesian Analysis of Kriging. <i>Technometrics</i>, <i>35</i>(4), 403–410. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1080/00401706.1993.10485354\">10.1080/00401706.1993.10485354</a>","url":"https://doi.org/10.1080/00401706.1993.10485354"},"Christoffersen_2018":{"label":"Christoffersen_2018","enumerator":"12","doi":"10.1038/s41467-018-03420-8","html":"Christoffersen, P., Bougamont, M., Hubbard, A., Doyle, S. H., Grigsby, S., & Pettersson, R. (2018). Cascading lake drainage on the Greenland Ice Sheet triggered by tensile shock and fracture. <i>Nature Communications</i>, <i>9</i>(1). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1038/s41467-018-03420-8\">10.1038/s41467-018-03420-8</a>","url":"https://doi.org/10.1038/s41467-018-03420-8"},"Morlighem_2017":{"label":"Morlighem_2017","enumerator":"13","doi":"10.1002/2017gl074954","html":"Morlighem, M., Williams, C. N., Rignot, E., An, L., Arndt, J. E., Bamber, J. L., Catania, G., Chauché, N., Dowdeswell, J. A., Dorschel, B., Fenty, I., Hogan, K., Howat, I., Hubbard, A., Jakobsson, M., Jordan, T. M., Kjeldsen, K. K., Millan, R., Mayer, L., … Zinglersen, K. B. (2017). BedMachine v3: Complete Bed Topography and Ocean Bathymetry Mapping of Greenland From Multibeam Echo Sounding Combined With Mass Conservation. <i>Geophysical Research Letters</i>, <i>44</i>(21). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1002/2017gl074954\">10.1002/2017gl074954</a>","url":"https://doi.org/10.1002/2017gl074954"},"MacKay_1992":{"label":"MacKay_1992","enumerator":"14","doi":"10.1162/neco.1992.4.3.415","html":"MacKay, D. J. C. (1992). Bayesian Interpolation. <i>Neural Computation</i>, <i>4</i>(3), 415–447. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1162/neco.1992.4.3.415\">10.1162/neco.1992.4.3.415</a>","url":"https://doi.org/10.1162/neco.1992.4.3.415"}}}},"footer":{"navigation":{"prev":{"title":"Coding Sample","url":"/","group":"Coding Sample"},"next":{"title":"Context for this coding & writing sample","url":"/gaussianprocesses-copy1","group":"Tmp"}}},"domain":"http://localhost:3001"}